2025-03-17 02:31:10,769 DEBUG [ptm/MainProcess] denovo.setup_model : model = None
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : config = None
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : output = /home/malla.s/Microbe/model_run
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : precursor_mass_tol = 50.0
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : isotope_error_range = (0, 1)
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : min_peptide_len = 6
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : predict_batch_size = 1024
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : n_beams = 1
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : top_match = 1
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : accelerator = auto
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : devices = None
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : random_seed = 454
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : n_log = 1
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : tb_summarywriter = None
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : save_top_k = 5
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : model_save_folder_path = 
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : val_check_interval = 50000
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : n_peaks = 150
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : min_mz = 50.0
2025-03-17 02:31:10,770 DEBUG [ptm/MainProcess] denovo.setup_model : max_mz = 2500.0
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : min_intensity = 0.01
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : remove_precursor_tol = 2.0
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : max_charge = 10
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : dim_model = 512
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : n_head = 8
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : dim_feedforward = 1024
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : n_layers = 9
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : dropout = 0.0
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : dim_intensity = None
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : max_length = 100
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : warmup_iters = 100000
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : cosine_schedule_period_iters = 600000
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : learning_rate = 0.0005
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : weight_decay = 1e-05
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : train_label_smoothing = 0.01
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : train_batch_size = 32
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : max_epochs = 30
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : num_sanity_val_steps = 0
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : calculate_precision = False
2025-03-17 02:31:10,771 DEBUG [ptm/MainProcess] denovo.setup_model : residues = {'G': 57.021464, 'A': 71.037114, 'S': 87.032028, 'P': 97.052764, 'V': 99.068414, 'T': 101.04767, 'C': 103.009185, 'L': 113.084064, 'I': 113.084064, 'N': 114.042927, 'D': 115.026943, 'Q': 128.058578, 'K': 128.094963, 'E': 129.042593, 'M': 131.040485, 'H': 137.058912, 'F': 147.068414, 'R': 156.101111, 'Y': 163.063329, 'W': 186.079313, 'G+57.02146': 114.042924, 'A+57.02146': 128.058574, 'S+57.02146': 144.053488, 'P+57.02146': 154.074224, 'V+57.02146': 156.089874, 'T+57.02146': 158.06913, 'C+57.02146': 160.030645, 'L+57.02146': 170.105524, 'I+57.02146': 170.105524, 'N+57.02146': 171.064387, 'D+57.02146': 172.048403, 'Q+57.02146': 185.080038, 'K+57.02146': 185.116423, 'E+57.02146': 186.064053, 'M+57.02146': 188.061945, 'H+57.02146': 194.080372, 'F+57.02146': 204.089874, 'R+57.02146': 213.122571, 'Y+57.02146': 220.084789, 'W+57.02146': 243.100773, 'G+15.994915': 73.016379, 'A+15.994915': 87.032029, 'S+15.994915': 103.026943, 'P+15.994915': 113.047679, 'V+15.994915': 115.063329, 'T+15.994915': 117.042585, 'C+15.994915': 119.0041, 'L+15.994915': 129.078979, 'I+15.994915': 129.078979, 'N+15.994915': 130.037842, 'D+15.994915': 131.021858, 'Q+15.994915': 144.053493, 'K+15.994915': 144.089878, 'E+15.994915': 145.037508, 'M+15.994915': 147.0354, 'H+15.994915': 153.053827, 'F+15.994915': 163.063329, 'R+15.994915': 172.096026, 'Y+15.994915': 179.058244, 'W+15.994915': 202.074228, 'G+42.010565': 99.032029, 'A+42.010565': 113.047679, 'S+42.010565': 129.042593, 'P+42.010565': 139.063329, 'V+42.010565': 141.078979, 'T+42.010565': 143.058235, 'C+42.010565': 145.01975, 'L+42.010565': 155.094629, 'I+42.010565': 155.094629, 'N+42.010565': 156.053492, 'D+42.010565': 157.037508, 'Q+42.010565': 170.069143, 'K+42.010565': 170.105528, 'E+42.010565': 171.053158, 'M+42.010565': 173.05105, 'H+42.010565': 179.069477, 'F+42.010565': 189.078979, 'R+42.010565': 198.111676, 'Y+42.010565': 205.073894, 'W+42.010565': 228.089878, 'C+57.021': 160.030645, 'M+15.995': 147.0354, 'K+42.011': 170.105528, 'C+57.02146+42.010565': 202.04121, 'C+42.010565+57.02146': 202.04121, 'G+57.02146+42.010565': 156.053489, 'G+42.010565+57.02146': 156.053489, 'A+57.02146+42.010565': 170.069139, 'A+42.010565+57.02146': 170.069139, 'S+57.02146+42.010565': 186.064053, 'S+42.010565+57.02146': 186.064053, 'P+57.02146+42.010565': 196.084789, 'P+42.010565+57.02146': 196.084789, 'V+57.02146+42.010565': 198.100439, 'V+42.010565+57.02146': 198.100439, 'T+57.02146+42.010565': 200.079695, 'T+42.010565+57.02146': 200.079695, 'L+57.02146+42.010565': 212.116089, 'L+42.010565+57.02146': 212.116089, 'I+57.02146+42.010565': 212.116089, 'I+42.010565+57.02146': 212.116089, 'N+57.02146+42.010565': 213.074952, 'N+42.010565+57.02146': 213.074952, 'D+57.02146+42.010565': 214.058968, 'D+42.010565+57.02146': 214.058968, 'Q+57.02146+42.010565': 227.090603, 'Q+42.010565+57.02146': 227.090603, 'K+57.02146+42.010565': 227.126988, 'K+42.010565+57.02146': 227.126988, 'E+57.02146+42.010565': 228.074618, 'E+42.010565+57.02146': 228.074618, 'M+57.02146+42.010565': 230.07251, 'M+42.010565+57.02146': 230.07251, 'H+57.02146+42.010565': 236.090937, 'H+42.010565+57.02146': 236.090937, 'F+57.02146+42.010565': 246.100439, 'F+42.010565+57.02146': 246.100439, 'R+57.02146+42.010565': 255.133136, 'R+42.010565+57.02146': 255.133136, 'Y+57.02146+42.010565': 262.095354, 'Y+42.010565+57.02146': 262.095354, 'W+57.02146+42.010565': 285.111338, 'W+42.010565+57.02146': 285.111338, 'G+57.02146+15.994915': 130.037839, 'G+15.994915+57.02146': 130.037839, 'A+57.02146+15.994915': 144.053489, 'A+15.994915+57.02146': 144.053489, 'S+57.02146+15.994915': 160.048403, 'S+15.994915+57.02146': 160.048403, 'P+57.02146+15.994915': 170.069139, 'P+15.994915+57.02146': 170.069139, 'V+57.02146+15.994915': 172.084789, 'V+15.994915+57.02146': 172.084789, 'T+57.02146+15.994915': 174.064045, 'T+15.994915+57.02146': 174.064045, 'C+57.02146+15.994915': 176.02556, 'C+15.994915+57.02146': 176.02556, 'L+57.02146+15.994915': 186.100439, 'L+15.994915+57.02146': 186.100439, 'I+57.02146+15.994915': 186.100439, 'I+15.994915+57.02146': 186.100439, 'N+57.02146+15.994915': 187.059302, 'N+15.994915+57.02146': 187.059302, 'D+57.02146+15.994915': 188.043318, 'D+15.994915+57.02146': 188.043318, 'Q+57.02146+15.994915': 201.074953, 'Q+15.994915+57.02146': 201.074953, 'K+57.02146+15.994915': 201.111338, 'K+15.994915+57.02146': 201.111338, 'E+57.02146+15.994915': 202.058968, 'E+15.994915+57.02146': 202.058968, 'M+57.02146+15.994915': 204.05686, 'M+15.994915+57.02146': 204.05686, 'H+57.02146+15.994915': 210.075287, 'H+15.994915+57.02146': 210.075287, 'F+57.02146+15.994915': 220.084789, 'F+15.994915+57.02146': 220.084789, 'R+57.02146+15.994915': 229.117486, 'R+15.994915+57.02146': 229.117486, 'Y+57.02146+15.994915': 236.079704, 'Y+15.994915+57.02146': 236.079704, 'W+57.02146+15.994915': 259.095688, 'W+15.994915+57.02146': 259.095688, 'G+15.994915+42.010565': 115.026944, 'G+42.010565+15.994915': 115.026944, 'A+15.994915+42.010565': 129.042594, 'A+42.010565+15.994915': 129.042594, 'S+15.994915+42.010565': 145.037508, 'S+42.010565+15.994915': 145.037508, 'P+15.994915+42.010565': 155.058244, 'P+42.010565+15.994915': 155.058244, 'V+15.994915+42.010565': 157.073894, 'V+42.010565+15.994915': 157.073894, 'T+15.994915+42.010565': 159.05315, 'T+42.010565+15.994915': 159.05315, 'C+15.994915+42.010565': 161.014665, 'C+42.010565+15.994915': 161.014665, 'L+15.994915+42.010565': 171.089544, 'L+42.010565+15.994915': 171.089544, 'I+15.994915+42.010565': 171.089544, 'I+42.010565+15.994915': 171.089544, 'N+15.994915+42.010565': 172.048407, 'N+42.010565+15.994915': 172.048407, 'D+15.994915+42.010565': 173.032423, 'D+42.010565+15.994915': 173.032423, 'Q+15.994915+42.010565': 186.064058, 'Q+42.010565+15.994915': 186.064058, 'K+15.994915+42.010565': 186.100443, 'K+42.010565+15.994915': 186.100443, 'E+15.994915+42.010565': 187.048073, 'E+42.010565+15.994915': 187.048073, 'M+15.994915+42.010565': 189.045965, 'M+42.010565+15.994915': 189.045965, 'H+15.994915+42.010565': 195.064392, 'H+42.010565+15.994915': 195.064392, 'F+15.994915+42.010565': 205.073894, 'F+42.010565+15.994915': 205.073894, 'R+15.994915+42.010565': 214.106591, 'R+42.010565+15.994915': 214.106591, 'Y+15.994915+42.010565': 221.068809, 'Y+42.010565+15.994915': 221.068809, 'W+15.994915+42.010565': 244.084793, 'W+42.010565+15.994915': 244.084793, 'G+57.02146+15.994915+42.010565': 172.048404, 'G+57.02146+42.010565+15.994915': 172.048404, 'G+15.994915+57.02146+42.010565': 172.048404, 'G+15.994915+42.010565+57.02146': 172.048404, 'G+42.010565+57.02146+15.994915': 172.048404, 'G+42.010565+15.994915+57.02146': 172.048404, 'A+57.02146+15.994915+42.010565': 186.064054, 'A+57.02146+42.010565+15.994915': 186.064054, 'A+15.994915+57.02146+42.010565': 186.064054, 'A+15.994915+42.010565+57.02146': 186.064054, 'A+42.010565+57.02146+15.994915': 186.064054, 'A+42.010565+15.994915+57.02146': 186.064054, 'S+57.02146+15.994915+42.010565': 202.058968, 'S+57.02146+42.010565+15.994915': 202.058968, 'S+15.994915+57.02146+42.010565': 202.058968, 'S+15.994915+42.010565+57.02146': 202.058968, 'S+42.010565+57.02146+15.994915': 202.058968, 'S+42.010565+15.994915+57.02146': 202.058968, 'P+57.02146+15.994915+42.010565': 212.079704, 'P+57.02146+42.010565+15.994915': 212.079704, 'P+15.994915+57.02146+42.010565': 212.079704, 'P+15.994915+42.010565+57.02146': 212.079704, 'P+42.010565+57.02146+15.994915': 212.079704, 'P+42.010565+15.994915+57.02146': 212.079704, 'V+57.02146+15.994915+42.010565': 214.095354, 'V+57.02146+42.010565+15.994915': 214.095354, 'V+15.994915+57.02146+42.010565': 214.095354, 'V+15.994915+42.010565+57.02146': 214.095354, 'V+42.010565+57.02146+15.994915': 214.095354, 'V+42.010565+15.994915+57.02146': 214.095354, 'T+57.02146+15.994915+42.010565': 216.07461, 'T+57.02146+42.010565+15.994915': 216.07461, 'T+15.994915+57.02146+42.010565': 216.07461, 'T+15.994915+42.010565+57.02146': 216.07461, 'T+42.010565+57.02146+15.994915': 216.07461, 'T+42.010565+15.994915+57.02146': 216.07461, 'C+57.02146+15.994915+42.010565': 218.036125, 'C+57.02146+42.010565+15.994915': 218.036125, 'C+15.994915+57.02146+42.010565': 218.036125, 'C+15.994915+42.010565+57.02146': 218.036125, 'C+42.010565+57.02146+15.994915': 218.036125, 'C+42.010565+15.994915+57.02146': 218.036125, 'L+57.02146+15.994915+42.010565': 228.111004, 'L+57.02146+42.010565+15.994915': 228.111004, 'L+15.994915+57.02146+42.010565': 228.111004, 'L+15.994915+42.010565+57.02146': 228.111004, 'L+42.010565+57.02146+15.994915': 228.111004, 'L+42.010565+15.994915+57.02146': 228.111004, 'I+57.02146+15.994915+42.010565': 228.111004, 'I+57.02146+42.010565+15.994915': 228.111004, 'I+15.994915+57.02146+42.010565': 228.111004, 'I+15.994915+42.010565+57.02146': 228.111004, 'I+42.010565+57.02146+15.994915': 228.111004, 'I+42.010565+15.994915+57.02146': 228.111004, 'N+57.02146+15.994915+42.010565': 229.069867, 'N+57.02146+42.010565+15.994915': 229.069867, 'N+15.994915+57.02146+42.010565': 229.069867, 'N+15.994915+42.010565+57.02146': 229.069867, 'N+42.010565+57.02146+15.994915': 229.069867, 'N+42.010565+15.994915+57.02146': 229.069867, 'D+57.02146+15.994915+42.010565': 230.053883, 'D+57.02146+42.010565+15.994915': 230.053883, 'D+15.994915+57.02146+42.010565': 230.053883, 'D+15.994915+42.010565+57.02146': 230.053883, 'D+42.010565+57.02146+15.994915': 230.053883, 'D+42.010565+15.994915+57.02146': 230.053883, 'Q+57.02146+15.994915+42.010565': 243.085518, 'Q+57.02146+42.010565+15.994915': 243.085518, 'Q+15.994915+57.02146+42.010565': 243.085518, 'Q+15.994915+42.010565+57.02146': 243.085518, 'Q+42.010565+57.02146+15.994915': 243.085518, 'Q+42.010565+15.994915+57.02146': 243.085518, 'K+57.02146+15.994915+42.010565': 243.121903, 'K+57.02146+42.010565+15.994915': 243.121903, 'K+15.994915+57.02146+42.010565': 243.121903, 'K+15.994915+42.010565+57.02146': 243.121903, 'K+42.010565+57.02146+15.994915': 243.121903, 'K+42.010565+15.994915+57.02146': 243.121903, 'E+57.02146+15.994915+42.010565': 244.069533, 'E+57.02146+42.010565+15.994915': 244.069533, 'E+15.994915+57.02146+42.010565': 244.069533, 'E+15.994915+42.010565+57.02146': 244.069533, 'E+42.010565+57.02146+15.994915': 244.069533, 'E+42.010565+15.994915+57.02146': 244.069533, 'M+57.02146+15.994915+42.010565': 246.067425, 'M+57.02146+42.010565+15.994915': 246.067425, 'M+15.994915+57.02146+42.010565': 246.067425, 'M+15.994915+42.010565+57.02146': 246.067425, 'M+42.010565+57.02146+15.994915': 246.067425, 'M+42.010565+15.994915+57.02146': 246.067425, 'H+57.02146+15.994915+42.010565': 252.085852, 'H+57.02146+42.010565+15.994915': 252.085852, 'H+15.994915+57.02146+42.010565': 252.085852, 'H+15.994915+42.010565+57.02146': 252.085852, 'H+42.010565+57.02146+15.994915': 252.085852, 'H+42.010565+15.994915+57.02146': 252.085852, 'F+57.02146+15.994915+42.010565': 262.095354, 'F+57.02146+42.010565+15.994915': 262.095354, 'F+15.994915+57.02146+42.010565': 262.095354, 'F+15.994915+42.010565+57.02146': 262.095354, 'F+42.010565+57.02146+15.994915': 262.095354, 'F+42.010565+15.994915+57.02146': 262.095354, 'R+57.02146+15.994915+42.010565': 271.128051, 'R+57.02146+42.010565+15.994915': 271.128051, 'R+15.994915+57.02146+42.010565': 271.128051, 'R+15.994915+42.010565+57.02146': 271.128051, 'R+42.010565+57.02146+15.994915': 271.128051, 'R+42.010565+15.994915+57.02146': 271.128051, 'Y+57.02146+15.994915+42.010565': 278.090269, 'Y+57.02146+42.010565+15.994915': 278.090269, 'Y+15.994915+57.02146+42.010565': 278.090269, 'Y+15.994915+42.010565+57.02146': 278.090269, 'Y+42.010565+57.02146+15.994915': 278.090269, 'Y+42.010565+15.994915+57.02146': 278.090269, 'W+57.02146+15.994915+42.010565': 301.106253, 'W+57.02146+42.010565+15.994915': 301.106253, 'W+15.994915+57.02146+42.010565': 301.106253, 'W+15.994915+42.010565+57.02146': 301.106253, 'W+42.010565+57.02146+15.994915': 301.106253, 'W+42.010565+15.994915+57.02146': 301.106253, '+42.010565': 42.010565, '+42.011': 42.010565, '+43.006': 43.005814, '-17.027': -17.026549, '+43.006-17.027': 25.980265}
2025-03-17 02:31:10,773 INFO [ptm/MainProcess] denovo.train : Training a model from:
2025-03-17 02:31:10,773 INFO [ptm/MainProcess] denovo.train :   src/datasets/train_set.mgf
2025-03-17 02:31:10,773 INFO [ptm/MainProcess] denovo.train : Using the following validation files:
2025-03-17 02:31:10,773 INFO [ptm/MainProcess] denovo.train :   src/datasets/val_set.mgf
2025-03-17 02:31:12,017 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 02:31:12,017 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 02:31:12,234 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 02:32:08,760 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 02:32:22,695 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 02:32:22,695 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 02:32:22,743 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 02:32:22,743 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 02:33:37,366 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 02:33:37,366 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 02:42:16,262 DEBUG [ptm/MainProcess] denovo.setup_model : model = None
2025-03-17 02:42:16,262 DEBUG [ptm/MainProcess] denovo.setup_model : config = None
2025-03-17 02:42:16,262 DEBUG [ptm/MainProcess] denovo.setup_model : output = /home/malla.s/Microbe/model_run
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : precursor_mass_tol = 50.0
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : isotope_error_range = (0, 1)
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : min_peptide_len = 6
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : predict_batch_size = 1024
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : n_beams = 1
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : top_match = 1
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : accelerator = auto
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : devices = None
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : random_seed = 454
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : n_log = 1
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : tb_summarywriter = None
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : save_top_k = 5
2025-03-17 02:42:16,263 DEBUG [ptm/MainProcess] denovo.setup_model : model_save_folder_path = 
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : val_check_interval = 50000
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : n_peaks = 150
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : min_mz = 50.0
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : max_mz = 2500.0
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : min_intensity = 0.01
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : remove_precursor_tol = 2.0
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : max_charge = 10
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : dim_model = 512
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : n_head = 8
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : dim_feedforward = 1024
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : n_layers = 9
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : dropout = 0.0
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : dim_intensity = None
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : max_length = 100
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : warmup_iters = 100000
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : cosine_schedule_period_iters = 600000
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : learning_rate = 0.0005
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : weight_decay = 1e-05
2025-03-17 02:42:16,264 DEBUG [ptm/MainProcess] denovo.setup_model : train_label_smoothing = 0.01
2025-03-17 02:42:16,265 DEBUG [ptm/MainProcess] denovo.setup_model : train_batch_size = 32
2025-03-17 02:42:16,265 DEBUG [ptm/MainProcess] denovo.setup_model : max_epochs = 1
2025-03-17 02:42:16,265 DEBUG [ptm/MainProcess] denovo.setup_model : num_sanity_val_steps = 0
2025-03-17 02:42:16,265 DEBUG [ptm/MainProcess] denovo.setup_model : calculate_precision = False
2025-03-17 02:42:16,265 DEBUG [ptm/MainProcess] denovo.setup_model : residues = {'G': 57.021464, 'A': 71.037114, 'S': 87.032028, 'P': 97.052764, 'V': 99.068414, 'T': 101.04767, 'C': 103.009185, 'L': 113.084064, 'I': 113.084064, 'N': 114.042927, 'D': 115.026943, 'Q': 128.058578, 'K': 128.094963, 'E': 129.042593, 'M': 131.040485, 'H': 137.058912, 'F': 147.068414, 'R': 156.101111, 'Y': 163.063329, 'W': 186.079313, 'G+57.02146': 114.042924, 'A+57.02146': 128.058574, 'S+57.02146': 144.053488, 'P+57.02146': 154.074224, 'V+57.02146': 156.089874, 'T+57.02146': 158.06913, 'C+57.02146': 160.030645, 'L+57.02146': 170.105524, 'I+57.02146': 170.105524, 'N+57.02146': 171.064387, 'D+57.02146': 172.048403, 'Q+57.02146': 185.080038, 'K+57.02146': 185.116423, 'E+57.02146': 186.064053, 'M+57.02146': 188.061945, 'H+57.02146': 194.080372, 'F+57.02146': 204.089874, 'R+57.02146': 213.122571, 'Y+57.02146': 220.084789, 'W+57.02146': 243.100773, 'G+15.994915': 73.016379, 'A+15.994915': 87.032029, 'S+15.994915': 103.026943, 'P+15.994915': 113.047679, 'V+15.994915': 115.063329, 'T+15.994915': 117.042585, 'C+15.994915': 119.0041, 'L+15.994915': 129.078979, 'I+15.994915': 129.078979, 'N+15.994915': 130.037842, 'D+15.994915': 131.021858, 'Q+15.994915': 144.053493, 'K+15.994915': 144.089878, 'E+15.994915': 145.037508, 'M+15.994915': 147.0354, 'H+15.994915': 153.053827, 'F+15.994915': 163.063329, 'R+15.994915': 172.096026, 'Y+15.994915': 179.058244, 'W+15.994915': 202.074228, 'G+42.010565': 99.032029, 'A+42.010565': 113.047679, 'S+42.010565': 129.042593, 'P+42.010565': 139.063329, 'V+42.010565': 141.078979, 'T+42.010565': 143.058235, 'C+42.010565': 145.01975, 'L+42.010565': 155.094629, 'I+42.010565': 155.094629, 'N+42.010565': 156.053492, 'D+42.010565': 157.037508, 'Q+42.010565': 170.069143, 'K+42.010565': 170.105528, 'E+42.010565': 171.053158, 'M+42.010565': 173.05105, 'H+42.010565': 179.069477, 'F+42.010565': 189.078979, 'R+42.010565': 198.111676, 'Y+42.010565': 205.073894, 'W+42.010565': 228.089878, 'C+57.021': 160.030645, 'M+15.995': 147.0354, 'K+42.011': 170.105528, 'C+57.02146+42.010565': 202.04121, 'C+42.010565+57.02146': 202.04121, 'G+57.02146+42.010565': 156.053489, 'G+42.010565+57.02146': 156.053489, 'A+57.02146+42.010565': 170.069139, 'A+42.010565+57.02146': 170.069139, 'S+57.02146+42.010565': 186.064053, 'S+42.010565+57.02146': 186.064053, 'P+57.02146+42.010565': 196.084789, 'P+42.010565+57.02146': 196.084789, 'V+57.02146+42.010565': 198.100439, 'V+42.010565+57.02146': 198.100439, 'T+57.02146+42.010565': 200.079695, 'T+42.010565+57.02146': 200.079695, 'L+57.02146+42.010565': 212.116089, 'L+42.010565+57.02146': 212.116089, 'I+57.02146+42.010565': 212.116089, 'I+42.010565+57.02146': 212.116089, 'N+57.02146+42.010565': 213.074952, 'N+42.010565+57.02146': 213.074952, 'D+57.02146+42.010565': 214.058968, 'D+42.010565+57.02146': 214.058968, 'Q+57.02146+42.010565': 227.090603, 'Q+42.010565+57.02146': 227.090603, 'K+57.02146+42.010565': 227.126988, 'K+42.010565+57.02146': 227.126988, 'E+57.02146+42.010565': 228.074618, 'E+42.010565+57.02146': 228.074618, 'M+57.02146+42.010565': 230.07251, 'M+42.010565+57.02146': 230.07251, 'H+57.02146+42.010565': 236.090937, 'H+42.010565+57.02146': 236.090937, 'F+57.02146+42.010565': 246.100439, 'F+42.010565+57.02146': 246.100439, 'R+57.02146+42.010565': 255.133136, 'R+42.010565+57.02146': 255.133136, 'Y+57.02146+42.010565': 262.095354, 'Y+42.010565+57.02146': 262.095354, 'W+57.02146+42.010565': 285.111338, 'W+42.010565+57.02146': 285.111338, 'G+57.02146+15.994915': 130.037839, 'G+15.994915+57.02146': 130.037839, 'A+57.02146+15.994915': 144.053489, 'A+15.994915+57.02146': 144.053489, 'S+57.02146+15.994915': 160.048403, 'S+15.994915+57.02146': 160.048403, 'P+57.02146+15.994915': 170.069139, 'P+15.994915+57.02146': 170.069139, 'V+57.02146+15.994915': 172.084789, 'V+15.994915+57.02146': 172.084789, 'T+57.02146+15.994915': 174.064045, 'T+15.994915+57.02146': 174.064045, 'C+57.02146+15.994915': 176.02556, 'C+15.994915+57.02146': 176.02556, 'L+57.02146+15.994915': 186.100439, 'L+15.994915+57.02146': 186.100439, 'I+57.02146+15.994915': 186.100439, 'I+15.994915+57.02146': 186.100439, 'N+57.02146+15.994915': 187.059302, 'N+15.994915+57.02146': 187.059302, 'D+57.02146+15.994915': 188.043318, 'D+15.994915+57.02146': 188.043318, 'Q+57.02146+15.994915': 201.074953, 'Q+15.994915+57.02146': 201.074953, 'K+57.02146+15.994915': 201.111338, 'K+15.994915+57.02146': 201.111338, 'E+57.02146+15.994915': 202.058968, 'E+15.994915+57.02146': 202.058968, 'M+57.02146+15.994915': 204.05686, 'M+15.994915+57.02146': 204.05686, 'H+57.02146+15.994915': 210.075287, 'H+15.994915+57.02146': 210.075287, 'F+57.02146+15.994915': 220.084789, 'F+15.994915+57.02146': 220.084789, 'R+57.02146+15.994915': 229.117486, 'R+15.994915+57.02146': 229.117486, 'Y+57.02146+15.994915': 236.079704, 'Y+15.994915+57.02146': 236.079704, 'W+57.02146+15.994915': 259.095688, 'W+15.994915+57.02146': 259.095688, 'G+15.994915+42.010565': 115.026944, 'G+42.010565+15.994915': 115.026944, 'A+15.994915+42.010565': 129.042594, 'A+42.010565+15.994915': 129.042594, 'S+15.994915+42.010565': 145.037508, 'S+42.010565+15.994915': 145.037508, 'P+15.994915+42.010565': 155.058244, 'P+42.010565+15.994915': 155.058244, 'V+15.994915+42.010565': 157.073894, 'V+42.010565+15.994915': 157.073894, 'T+15.994915+42.010565': 159.05315, 'T+42.010565+15.994915': 159.05315, 'C+15.994915+42.010565': 161.014665, 'C+42.010565+15.994915': 161.014665, 'L+15.994915+42.010565': 171.089544, 'L+42.010565+15.994915': 171.089544, 'I+15.994915+42.010565': 171.089544, 'I+42.010565+15.994915': 171.089544, 'N+15.994915+42.010565': 172.048407, 'N+42.010565+15.994915': 172.048407, 'D+15.994915+42.010565': 173.032423, 'D+42.010565+15.994915': 173.032423, 'Q+15.994915+42.010565': 186.064058, 'Q+42.010565+15.994915': 186.064058, 'K+15.994915+42.010565': 186.100443, 'K+42.010565+15.994915': 186.100443, 'E+15.994915+42.010565': 187.048073, 'E+42.010565+15.994915': 187.048073, 'M+15.994915+42.010565': 189.045965, 'M+42.010565+15.994915': 189.045965, 'H+15.994915+42.010565': 195.064392, 'H+42.010565+15.994915': 195.064392, 'F+15.994915+42.010565': 205.073894, 'F+42.010565+15.994915': 205.073894, 'R+15.994915+42.010565': 214.106591, 'R+42.010565+15.994915': 214.106591, 'Y+15.994915+42.010565': 221.068809, 'Y+42.010565+15.994915': 221.068809, 'W+15.994915+42.010565': 244.084793, 'W+42.010565+15.994915': 244.084793, 'G+57.02146+15.994915+42.010565': 172.048404, 'G+57.02146+42.010565+15.994915': 172.048404, 'G+15.994915+57.02146+42.010565': 172.048404, 'G+15.994915+42.010565+57.02146': 172.048404, 'G+42.010565+57.02146+15.994915': 172.048404, 'G+42.010565+15.994915+57.02146': 172.048404, 'A+57.02146+15.994915+42.010565': 186.064054, 'A+57.02146+42.010565+15.994915': 186.064054, 'A+15.994915+57.02146+42.010565': 186.064054, 'A+15.994915+42.010565+57.02146': 186.064054, 'A+42.010565+57.02146+15.994915': 186.064054, 'A+42.010565+15.994915+57.02146': 186.064054, 'S+57.02146+15.994915+42.010565': 202.058968, 'S+57.02146+42.010565+15.994915': 202.058968, 'S+15.994915+57.02146+42.010565': 202.058968, 'S+15.994915+42.010565+57.02146': 202.058968, 'S+42.010565+57.02146+15.994915': 202.058968, 'S+42.010565+15.994915+57.02146': 202.058968, 'P+57.02146+15.994915+42.010565': 212.079704, 'P+57.02146+42.010565+15.994915': 212.079704, 'P+15.994915+57.02146+42.010565': 212.079704, 'P+15.994915+42.010565+57.02146': 212.079704, 'P+42.010565+57.02146+15.994915': 212.079704, 'P+42.010565+15.994915+57.02146': 212.079704, 'V+57.02146+15.994915+42.010565': 214.095354, 'V+57.02146+42.010565+15.994915': 214.095354, 'V+15.994915+57.02146+42.010565': 214.095354, 'V+15.994915+42.010565+57.02146': 214.095354, 'V+42.010565+57.02146+15.994915': 214.095354, 'V+42.010565+15.994915+57.02146': 214.095354, 'T+57.02146+15.994915+42.010565': 216.07461, 'T+57.02146+42.010565+15.994915': 216.07461, 'T+15.994915+57.02146+42.010565': 216.07461, 'T+15.994915+42.010565+57.02146': 216.07461, 'T+42.010565+57.02146+15.994915': 216.07461, 'T+42.010565+15.994915+57.02146': 216.07461, 'C+57.02146+15.994915+42.010565': 218.036125, 'C+57.02146+42.010565+15.994915': 218.036125, 'C+15.994915+57.02146+42.010565': 218.036125, 'C+15.994915+42.010565+57.02146': 218.036125, 'C+42.010565+57.02146+15.994915': 218.036125, 'C+42.010565+15.994915+57.02146': 218.036125, 'L+57.02146+15.994915+42.010565': 228.111004, 'L+57.02146+42.010565+15.994915': 228.111004, 'L+15.994915+57.02146+42.010565': 228.111004, 'L+15.994915+42.010565+57.02146': 228.111004, 'L+42.010565+57.02146+15.994915': 228.111004, 'L+42.010565+15.994915+57.02146': 228.111004, 'I+57.02146+15.994915+42.010565': 228.111004, 'I+57.02146+42.010565+15.994915': 228.111004, 'I+15.994915+57.02146+42.010565': 228.111004, 'I+15.994915+42.010565+57.02146': 228.111004, 'I+42.010565+57.02146+15.994915': 228.111004, 'I+42.010565+15.994915+57.02146': 228.111004, 'N+57.02146+15.994915+42.010565': 229.069867, 'N+57.02146+42.010565+15.994915': 229.069867, 'N+15.994915+57.02146+42.010565': 229.069867, 'N+15.994915+42.010565+57.02146': 229.069867, 'N+42.010565+57.02146+15.994915': 229.069867, 'N+42.010565+15.994915+57.02146': 229.069867, 'D+57.02146+15.994915+42.010565': 230.053883, 'D+57.02146+42.010565+15.994915': 230.053883, 'D+15.994915+57.02146+42.010565': 230.053883, 'D+15.994915+42.010565+57.02146': 230.053883, 'D+42.010565+57.02146+15.994915': 230.053883, 'D+42.010565+15.994915+57.02146': 230.053883, 'Q+57.02146+15.994915+42.010565': 243.085518, 'Q+57.02146+42.010565+15.994915': 243.085518, 'Q+15.994915+57.02146+42.010565': 243.085518, 'Q+15.994915+42.010565+57.02146': 243.085518, 'Q+42.010565+57.02146+15.994915': 243.085518, 'Q+42.010565+15.994915+57.02146': 243.085518, 'K+57.02146+15.994915+42.010565': 243.121903, 'K+57.02146+42.010565+15.994915': 243.121903, 'K+15.994915+57.02146+42.010565': 243.121903, 'K+15.994915+42.010565+57.02146': 243.121903, 'K+42.010565+57.02146+15.994915': 243.121903, 'K+42.010565+15.994915+57.02146': 243.121903, 'E+57.02146+15.994915+42.010565': 244.069533, 'E+57.02146+42.010565+15.994915': 244.069533, 'E+15.994915+57.02146+42.010565': 244.069533, 'E+15.994915+42.010565+57.02146': 244.069533, 'E+42.010565+57.02146+15.994915': 244.069533, 'E+42.010565+15.994915+57.02146': 244.069533, 'M+57.02146+15.994915+42.010565': 246.067425, 'M+57.02146+42.010565+15.994915': 246.067425, 'M+15.994915+57.02146+42.010565': 246.067425, 'M+15.994915+42.010565+57.02146': 246.067425, 'M+42.010565+57.02146+15.994915': 246.067425, 'M+42.010565+15.994915+57.02146': 246.067425, 'H+57.02146+15.994915+42.010565': 252.085852, 'H+57.02146+42.010565+15.994915': 252.085852, 'H+15.994915+57.02146+42.010565': 252.085852, 'H+15.994915+42.010565+57.02146': 252.085852, 'H+42.010565+57.02146+15.994915': 252.085852, 'H+42.010565+15.994915+57.02146': 252.085852, 'F+57.02146+15.994915+42.010565': 262.095354, 'F+57.02146+42.010565+15.994915': 262.095354, 'F+15.994915+57.02146+42.010565': 262.095354, 'F+15.994915+42.010565+57.02146': 262.095354, 'F+42.010565+57.02146+15.994915': 262.095354, 'F+42.010565+15.994915+57.02146': 262.095354, 'R+57.02146+15.994915+42.010565': 271.128051, 'R+57.02146+42.010565+15.994915': 271.128051, 'R+15.994915+57.02146+42.010565': 271.128051, 'R+15.994915+42.010565+57.02146': 271.128051, 'R+42.010565+57.02146+15.994915': 271.128051, 'R+42.010565+15.994915+57.02146': 271.128051, 'Y+57.02146+15.994915+42.010565': 278.090269, 'Y+57.02146+42.010565+15.994915': 278.090269, 'Y+15.994915+57.02146+42.010565': 278.090269, 'Y+15.994915+42.010565+57.02146': 278.090269, 'Y+42.010565+57.02146+15.994915': 278.090269, 'Y+42.010565+15.994915+57.02146': 278.090269, 'W+57.02146+15.994915+42.010565': 301.106253, 'W+57.02146+42.010565+15.994915': 301.106253, 'W+15.994915+57.02146+42.010565': 301.106253, 'W+15.994915+42.010565+57.02146': 301.106253, 'W+42.010565+57.02146+15.994915': 301.106253, 'W+42.010565+15.994915+57.02146': 301.106253, '+42.010565': 42.010565, '+42.011': 42.010565, '+43.006': 43.005814, '-17.027': -17.026549, '+43.006-17.027': 25.980265}
2025-03-17 02:42:16,267 INFO [ptm/MainProcess] denovo.train : Training a model from:
2025-03-17 02:42:16,267 INFO [ptm/MainProcess] denovo.train :   src/datasets/train_set.mgf
2025-03-17 02:42:16,267 INFO [ptm/MainProcess] denovo.train : Using the following validation files:
2025-03-17 02:42:16,267 INFO [ptm/MainProcess] denovo.train :   src/datasets/val_set.mgf
2025-03-17 02:42:17,508 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 02:42:17,508 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 02:42:17,795 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 02:43:15,631 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 02:43:29,680 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 02:43:29,680 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 02:43:29,743 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 02:43:29,743 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 02:44:40,879 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 02:44:40,879 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:13:38,453 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 10. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:13:38,453 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 10. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : model = None
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : config = None
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : output = /home/malla.s/Microbe/model_run
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : precursor_mass_tol = 50.0
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : isotope_error_range = (0, 1)
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : min_peptide_len = 6
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : predict_batch_size = 1024
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : n_beams = 1
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : top_match = 1
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : accelerator = auto
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : devices = None
2025-03-17 03:25:52,315 DEBUG [ptm/MainProcess] denovo.setup_model : random_seed = 454
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : n_log = 1
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : tb_summarywriter = None
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : save_top_k = 5
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : model_save_folder_path = 
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : val_check_interval = 50000
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : n_peaks = 150
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : min_mz = 50.0
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : max_mz = 2500.0
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : min_intensity = 0.01
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : remove_precursor_tol = 2.0
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : max_charge = 10
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : dim_model = 512
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : n_head = 8
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : dim_feedforward = 1024
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : n_layers = 9
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : dropout = 0.0
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : dim_intensity = None
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : max_length = 100
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : warmup_iters = 100000
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : cosine_schedule_period_iters = 600000
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : learning_rate = 0.0005
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : weight_decay = 1e-05
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : train_label_smoothing = 0.01
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : train_batch_size = 32
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : max_epochs = 1
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : num_sanity_val_steps = 0
2025-03-17 03:25:52,316 DEBUG [ptm/MainProcess] denovo.setup_model : calculate_precision = False
2025-03-17 03:25:52,317 DEBUG [ptm/MainProcess] denovo.setup_model : residues = {'G': 57.021464, 'A': 71.037114, 'S': 87.032028, 'P': 97.052764, 'V': 99.068414, 'T': 101.04767, 'C': 103.009185, 'L': 113.084064, 'I': 113.084064, 'N': 114.042927, 'D': 115.026943, 'Q': 128.058578, 'K': 128.094963, 'E': 129.042593, 'M': 131.040485, 'H': 137.058912, 'F': 147.068414, 'R': 156.101111, 'Y': 163.063329, 'W': 186.079313, 'G+57.02146': 114.042924, 'A+57.02146': 128.058574, 'S+57.02146': 144.053488, 'P+57.02146': 154.074224, 'V+57.02146': 156.089874, 'T+57.02146': 158.06913, 'C+57.02146': 160.030645, 'L+57.02146': 170.105524, 'I+57.02146': 170.105524, 'N+57.02146': 171.064387, 'D+57.02146': 172.048403, 'Q+57.02146': 185.080038, 'K+57.02146': 185.116423, 'E+57.02146': 186.064053, 'M+57.02146': 188.061945, 'H+57.02146': 194.080372, 'F+57.02146': 204.089874, 'R+57.02146': 213.122571, 'Y+57.02146': 220.084789, 'W+57.02146': 243.100773, 'G+15.994915': 73.016379, 'A+15.994915': 87.032029, 'S+15.994915': 103.026943, 'P+15.994915': 113.047679, 'V+15.994915': 115.063329, 'T+15.994915': 117.042585, 'C+15.994915': 119.0041, 'L+15.994915': 129.078979, 'I+15.994915': 129.078979, 'N+15.994915': 130.037842, 'D+15.994915': 131.021858, 'Q+15.994915': 144.053493, 'K+15.994915': 144.089878, 'E+15.994915': 145.037508, 'M+15.994915': 147.0354, 'H+15.994915': 153.053827, 'F+15.994915': 163.063329, 'R+15.994915': 172.096026, 'Y+15.994915': 179.058244, 'W+15.994915': 202.074228, 'G+42.010565': 99.032029, 'A+42.010565': 113.047679, 'S+42.010565': 129.042593, 'P+42.010565': 139.063329, 'V+42.010565': 141.078979, 'T+42.010565': 143.058235, 'C+42.010565': 145.01975, 'L+42.010565': 155.094629, 'I+42.010565': 155.094629, 'N+42.010565': 156.053492, 'D+42.010565': 157.037508, 'Q+42.010565': 170.069143, 'K+42.010565': 170.105528, 'E+42.010565': 171.053158, 'M+42.010565': 173.05105, 'H+42.010565': 179.069477, 'F+42.010565': 189.078979, 'R+42.010565': 198.111676, 'Y+42.010565': 205.073894, 'W+42.010565': 228.089878, 'C+57.021': 160.030645, 'M+15.995': 147.0354, 'K+42.011': 170.105528, 'C+57.02146+42.010565': 202.04121, 'C+42.010565+57.02146': 202.04121, 'G+57.02146+42.010565': 156.053489, 'G+42.010565+57.02146': 156.053489, 'A+57.02146+42.010565': 170.069139, 'A+42.010565+57.02146': 170.069139, 'S+57.02146+42.010565': 186.064053, 'S+42.010565+57.02146': 186.064053, 'P+57.02146+42.010565': 196.084789, 'P+42.010565+57.02146': 196.084789, 'V+57.02146+42.010565': 198.100439, 'V+42.010565+57.02146': 198.100439, 'T+57.02146+42.010565': 200.079695, 'T+42.010565+57.02146': 200.079695, 'L+57.02146+42.010565': 212.116089, 'L+42.010565+57.02146': 212.116089, 'I+57.02146+42.010565': 212.116089, 'I+42.010565+57.02146': 212.116089, 'N+57.02146+42.010565': 213.074952, 'N+42.010565+57.02146': 213.074952, 'D+57.02146+42.010565': 214.058968, 'D+42.010565+57.02146': 214.058968, 'Q+57.02146+42.010565': 227.090603, 'Q+42.010565+57.02146': 227.090603, 'K+57.02146+42.010565': 227.126988, 'K+42.010565+57.02146': 227.126988, 'E+57.02146+42.010565': 228.074618, 'E+42.010565+57.02146': 228.074618, 'M+57.02146+42.010565': 230.07251, 'M+42.010565+57.02146': 230.07251, 'H+57.02146+42.010565': 236.090937, 'H+42.010565+57.02146': 236.090937, 'F+57.02146+42.010565': 246.100439, 'F+42.010565+57.02146': 246.100439, 'R+57.02146+42.010565': 255.133136, 'R+42.010565+57.02146': 255.133136, 'Y+57.02146+42.010565': 262.095354, 'Y+42.010565+57.02146': 262.095354, 'W+57.02146+42.010565': 285.111338, 'W+42.010565+57.02146': 285.111338, 'G+57.02146+15.994915': 130.037839, 'G+15.994915+57.02146': 130.037839, 'A+57.02146+15.994915': 144.053489, 'A+15.994915+57.02146': 144.053489, 'S+57.02146+15.994915': 160.048403, 'S+15.994915+57.02146': 160.048403, 'P+57.02146+15.994915': 170.069139, 'P+15.994915+57.02146': 170.069139, 'V+57.02146+15.994915': 172.084789, 'V+15.994915+57.02146': 172.084789, 'T+57.02146+15.994915': 174.064045, 'T+15.994915+57.02146': 174.064045, 'C+57.02146+15.994915': 176.02556, 'C+15.994915+57.02146': 176.02556, 'L+57.02146+15.994915': 186.100439, 'L+15.994915+57.02146': 186.100439, 'I+57.02146+15.994915': 186.100439, 'I+15.994915+57.02146': 186.100439, 'N+57.02146+15.994915': 187.059302, 'N+15.994915+57.02146': 187.059302, 'D+57.02146+15.994915': 188.043318, 'D+15.994915+57.02146': 188.043318, 'Q+57.02146+15.994915': 201.074953, 'Q+15.994915+57.02146': 201.074953, 'K+57.02146+15.994915': 201.111338, 'K+15.994915+57.02146': 201.111338, 'E+57.02146+15.994915': 202.058968, 'E+15.994915+57.02146': 202.058968, 'M+57.02146+15.994915': 204.05686, 'M+15.994915+57.02146': 204.05686, 'H+57.02146+15.994915': 210.075287, 'H+15.994915+57.02146': 210.075287, 'F+57.02146+15.994915': 220.084789, 'F+15.994915+57.02146': 220.084789, 'R+57.02146+15.994915': 229.117486, 'R+15.994915+57.02146': 229.117486, 'Y+57.02146+15.994915': 236.079704, 'Y+15.994915+57.02146': 236.079704, 'W+57.02146+15.994915': 259.095688, 'W+15.994915+57.02146': 259.095688, 'G+15.994915+42.010565': 115.026944, 'G+42.010565+15.994915': 115.026944, 'A+15.994915+42.010565': 129.042594, 'A+42.010565+15.994915': 129.042594, 'S+15.994915+42.010565': 145.037508, 'S+42.010565+15.994915': 145.037508, 'P+15.994915+42.010565': 155.058244, 'P+42.010565+15.994915': 155.058244, 'V+15.994915+42.010565': 157.073894, 'V+42.010565+15.994915': 157.073894, 'T+15.994915+42.010565': 159.05315, 'T+42.010565+15.994915': 159.05315, 'C+15.994915+42.010565': 161.014665, 'C+42.010565+15.994915': 161.014665, 'L+15.994915+42.010565': 171.089544, 'L+42.010565+15.994915': 171.089544, 'I+15.994915+42.010565': 171.089544, 'I+42.010565+15.994915': 171.089544, 'N+15.994915+42.010565': 172.048407, 'N+42.010565+15.994915': 172.048407, 'D+15.994915+42.010565': 173.032423, 'D+42.010565+15.994915': 173.032423, 'Q+15.994915+42.010565': 186.064058, 'Q+42.010565+15.994915': 186.064058, 'K+15.994915+42.010565': 186.100443, 'K+42.010565+15.994915': 186.100443, 'E+15.994915+42.010565': 187.048073, 'E+42.010565+15.994915': 187.048073, 'M+15.994915+42.010565': 189.045965, 'M+42.010565+15.994915': 189.045965, 'H+15.994915+42.010565': 195.064392, 'H+42.010565+15.994915': 195.064392, 'F+15.994915+42.010565': 205.073894, 'F+42.010565+15.994915': 205.073894, 'R+15.994915+42.010565': 214.106591, 'R+42.010565+15.994915': 214.106591, 'Y+15.994915+42.010565': 221.068809, 'Y+42.010565+15.994915': 221.068809, 'W+15.994915+42.010565': 244.084793, 'W+42.010565+15.994915': 244.084793, 'G+57.02146+15.994915+42.010565': 172.048404, 'G+57.02146+42.010565+15.994915': 172.048404, 'G+15.994915+57.02146+42.010565': 172.048404, 'G+15.994915+42.010565+57.02146': 172.048404, 'G+42.010565+57.02146+15.994915': 172.048404, 'G+42.010565+15.994915+57.02146': 172.048404, 'A+57.02146+15.994915+42.010565': 186.064054, 'A+57.02146+42.010565+15.994915': 186.064054, 'A+15.994915+57.02146+42.010565': 186.064054, 'A+15.994915+42.010565+57.02146': 186.064054, 'A+42.010565+57.02146+15.994915': 186.064054, 'A+42.010565+15.994915+57.02146': 186.064054, 'S+57.02146+15.994915+42.010565': 202.058968, 'S+57.02146+42.010565+15.994915': 202.058968, 'S+15.994915+57.02146+42.010565': 202.058968, 'S+15.994915+42.010565+57.02146': 202.058968, 'S+42.010565+57.02146+15.994915': 202.058968, 'S+42.010565+15.994915+57.02146': 202.058968, 'P+57.02146+15.994915+42.010565': 212.079704, 'P+57.02146+42.010565+15.994915': 212.079704, 'P+15.994915+57.02146+42.010565': 212.079704, 'P+15.994915+42.010565+57.02146': 212.079704, 'P+42.010565+57.02146+15.994915': 212.079704, 'P+42.010565+15.994915+57.02146': 212.079704, 'V+57.02146+15.994915+42.010565': 214.095354, 'V+57.02146+42.010565+15.994915': 214.095354, 'V+15.994915+57.02146+42.010565': 214.095354, 'V+15.994915+42.010565+57.02146': 214.095354, 'V+42.010565+57.02146+15.994915': 214.095354, 'V+42.010565+15.994915+57.02146': 214.095354, 'T+57.02146+15.994915+42.010565': 216.07461, 'T+57.02146+42.010565+15.994915': 216.07461, 'T+15.994915+57.02146+42.010565': 216.07461, 'T+15.994915+42.010565+57.02146': 216.07461, 'T+42.010565+57.02146+15.994915': 216.07461, 'T+42.010565+15.994915+57.02146': 216.07461, 'C+57.02146+15.994915+42.010565': 218.036125, 'C+57.02146+42.010565+15.994915': 218.036125, 'C+15.994915+57.02146+42.010565': 218.036125, 'C+15.994915+42.010565+57.02146': 218.036125, 'C+42.010565+57.02146+15.994915': 218.036125, 'C+42.010565+15.994915+57.02146': 218.036125, 'L+57.02146+15.994915+42.010565': 228.111004, 'L+57.02146+42.010565+15.994915': 228.111004, 'L+15.994915+57.02146+42.010565': 228.111004, 'L+15.994915+42.010565+57.02146': 228.111004, 'L+42.010565+57.02146+15.994915': 228.111004, 'L+42.010565+15.994915+57.02146': 228.111004, 'I+57.02146+15.994915+42.010565': 228.111004, 'I+57.02146+42.010565+15.994915': 228.111004, 'I+15.994915+57.02146+42.010565': 228.111004, 'I+15.994915+42.010565+57.02146': 228.111004, 'I+42.010565+57.02146+15.994915': 228.111004, 'I+42.010565+15.994915+57.02146': 228.111004, 'N+57.02146+15.994915+42.010565': 229.069867, 'N+57.02146+42.010565+15.994915': 229.069867, 'N+15.994915+57.02146+42.010565': 229.069867, 'N+15.994915+42.010565+57.02146': 229.069867, 'N+42.010565+57.02146+15.994915': 229.069867, 'N+42.010565+15.994915+57.02146': 229.069867, 'D+57.02146+15.994915+42.010565': 230.053883, 'D+57.02146+42.010565+15.994915': 230.053883, 'D+15.994915+57.02146+42.010565': 230.053883, 'D+15.994915+42.010565+57.02146': 230.053883, 'D+42.010565+57.02146+15.994915': 230.053883, 'D+42.010565+15.994915+57.02146': 230.053883, 'Q+57.02146+15.994915+42.010565': 243.085518, 'Q+57.02146+42.010565+15.994915': 243.085518, 'Q+15.994915+57.02146+42.010565': 243.085518, 'Q+15.994915+42.010565+57.02146': 243.085518, 'Q+42.010565+57.02146+15.994915': 243.085518, 'Q+42.010565+15.994915+57.02146': 243.085518, 'K+57.02146+15.994915+42.010565': 243.121903, 'K+57.02146+42.010565+15.994915': 243.121903, 'K+15.994915+57.02146+42.010565': 243.121903, 'K+15.994915+42.010565+57.02146': 243.121903, 'K+42.010565+57.02146+15.994915': 243.121903, 'K+42.010565+15.994915+57.02146': 243.121903, 'E+57.02146+15.994915+42.010565': 244.069533, 'E+57.02146+42.010565+15.994915': 244.069533, 'E+15.994915+57.02146+42.010565': 244.069533, 'E+15.994915+42.010565+57.02146': 244.069533, 'E+42.010565+57.02146+15.994915': 244.069533, 'E+42.010565+15.994915+57.02146': 244.069533, 'M+57.02146+15.994915+42.010565': 246.067425, 'M+57.02146+42.010565+15.994915': 246.067425, 'M+15.994915+57.02146+42.010565': 246.067425, 'M+15.994915+42.010565+57.02146': 246.067425, 'M+42.010565+57.02146+15.994915': 246.067425, 'M+42.010565+15.994915+57.02146': 246.067425, 'H+57.02146+15.994915+42.010565': 252.085852, 'H+57.02146+42.010565+15.994915': 252.085852, 'H+15.994915+57.02146+42.010565': 252.085852, 'H+15.994915+42.010565+57.02146': 252.085852, 'H+42.010565+57.02146+15.994915': 252.085852, 'H+42.010565+15.994915+57.02146': 252.085852, 'F+57.02146+15.994915+42.010565': 262.095354, 'F+57.02146+42.010565+15.994915': 262.095354, 'F+15.994915+57.02146+42.010565': 262.095354, 'F+15.994915+42.010565+57.02146': 262.095354, 'F+42.010565+57.02146+15.994915': 262.095354, 'F+42.010565+15.994915+57.02146': 262.095354, 'R+57.02146+15.994915+42.010565': 271.128051, 'R+57.02146+42.010565+15.994915': 271.128051, 'R+15.994915+57.02146+42.010565': 271.128051, 'R+15.994915+42.010565+57.02146': 271.128051, 'R+42.010565+57.02146+15.994915': 271.128051, 'R+42.010565+15.994915+57.02146': 271.128051, 'Y+57.02146+15.994915+42.010565': 278.090269, 'Y+57.02146+42.010565+15.994915': 278.090269, 'Y+15.994915+57.02146+42.010565': 278.090269, 'Y+15.994915+42.010565+57.02146': 278.090269, 'Y+42.010565+57.02146+15.994915': 278.090269, 'Y+42.010565+15.994915+57.02146': 278.090269, 'W+57.02146+15.994915+42.010565': 301.106253, 'W+57.02146+42.010565+15.994915': 301.106253, 'W+15.994915+57.02146+42.010565': 301.106253, 'W+15.994915+42.010565+57.02146': 301.106253, 'W+42.010565+57.02146+15.994915': 301.106253, 'W+42.010565+15.994915+57.02146': 301.106253, '+42.010565': 42.010565, '+42.011': 42.010565, '+43.006': 43.005814, '-17.027': -17.026549, '+43.006-17.027': 25.980265}
2025-03-17 03:25:52,317 INFO [ptm/MainProcess] denovo.train : Training a model from:
2025-03-17 03:25:52,317 INFO [ptm/MainProcess] denovo.train :   src/datasets/train_set.mgf
2025-03-17 03:25:52,318 INFO [ptm/MainProcess] denovo.train : Using the following validation files:
2025-03-17 03:25:52,318 INFO [ptm/MainProcess] denovo.train :   src/datasets/val_set.mgf
2025-03-17 03:25:53,501 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 03:25:53,501 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 03:25:53,754 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 03:25:55,221 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 03:25:55,681 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 03:25:55,681 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 03:25:55,736 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 03:25:55,736 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 03:26:25,140 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:26:25,140 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:27:02,304 INFO [ptm/MainProcess] model._log_history : Step	Train loss	Valid loss	
2025-03-17 03:27:02,305 INFO [ptm/MainProcess] model._log_history : 250	5.191629	nan
2025-03-17 03:27:03,320 INFO [ptm/MainProcess] denovo.train : DONE!
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : model = None
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : config = None
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : output = /home/malla.s/Microbe/model_run
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : precursor_mass_tol = 50.0
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : isotope_error_range = (0, 1)
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : min_peptide_len = 6
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : predict_batch_size = 1024
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : n_beams = 1
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : top_match = 1
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : accelerator = auto
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : devices = None
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : random_seed = 454
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : n_log = 1
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : tb_summarywriter = None
2025-03-17 03:27:46,741 DEBUG [ptm/MainProcess] denovo.setup_model : save_top_k = 5
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : model_save_folder_path = 
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : val_check_interval = 50000
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : n_peaks = 150
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : min_mz = 50.0
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : max_mz = 2500.0
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : min_intensity = 0.01
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : remove_precursor_tol = 2.0
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : max_charge = 10
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : dim_model = 512
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : n_head = 8
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : dim_feedforward = 1024
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : n_layers = 9
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : dropout = 0.0
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : dim_intensity = None
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : max_length = 100
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : warmup_iters = 100000
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : cosine_schedule_period_iters = 600000
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : learning_rate = 0.0005
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : weight_decay = 1e-05
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : train_label_smoothing = 0.01
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : train_batch_size = 32
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : max_epochs = 10
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : num_sanity_val_steps = 0
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : calculate_precision = False
2025-03-17 03:27:46,742 DEBUG [ptm/MainProcess] denovo.setup_model : residues = {'G': 57.021464, 'A': 71.037114, 'S': 87.032028, 'P': 97.052764, 'V': 99.068414, 'T': 101.04767, 'C': 103.009185, 'L': 113.084064, 'I': 113.084064, 'N': 114.042927, 'D': 115.026943, 'Q': 128.058578, 'K': 128.094963, 'E': 129.042593, 'M': 131.040485, 'H': 137.058912, 'F': 147.068414, 'R': 156.101111, 'Y': 163.063329, 'W': 186.079313, 'G+57.02146': 114.042924, 'A+57.02146': 128.058574, 'S+57.02146': 144.053488, 'P+57.02146': 154.074224, 'V+57.02146': 156.089874, 'T+57.02146': 158.06913, 'C+57.02146': 160.030645, 'L+57.02146': 170.105524, 'I+57.02146': 170.105524, 'N+57.02146': 171.064387, 'D+57.02146': 172.048403, 'Q+57.02146': 185.080038, 'K+57.02146': 185.116423, 'E+57.02146': 186.064053, 'M+57.02146': 188.061945, 'H+57.02146': 194.080372, 'F+57.02146': 204.089874, 'R+57.02146': 213.122571, 'Y+57.02146': 220.084789, 'W+57.02146': 243.100773, 'G+15.994915': 73.016379, 'A+15.994915': 87.032029, 'S+15.994915': 103.026943, 'P+15.994915': 113.047679, 'V+15.994915': 115.063329, 'T+15.994915': 117.042585, 'C+15.994915': 119.0041, 'L+15.994915': 129.078979, 'I+15.994915': 129.078979, 'N+15.994915': 130.037842, 'D+15.994915': 131.021858, 'Q+15.994915': 144.053493, 'K+15.994915': 144.089878, 'E+15.994915': 145.037508, 'M+15.994915': 147.0354, 'H+15.994915': 153.053827, 'F+15.994915': 163.063329, 'R+15.994915': 172.096026, 'Y+15.994915': 179.058244, 'W+15.994915': 202.074228, 'G+42.010565': 99.032029, 'A+42.010565': 113.047679, 'S+42.010565': 129.042593, 'P+42.010565': 139.063329, 'V+42.010565': 141.078979, 'T+42.010565': 143.058235, 'C+42.010565': 145.01975, 'L+42.010565': 155.094629, 'I+42.010565': 155.094629, 'N+42.010565': 156.053492, 'D+42.010565': 157.037508, 'Q+42.010565': 170.069143, 'K+42.010565': 170.105528, 'E+42.010565': 171.053158, 'M+42.010565': 173.05105, 'H+42.010565': 179.069477, 'F+42.010565': 189.078979, 'R+42.010565': 198.111676, 'Y+42.010565': 205.073894, 'W+42.010565': 228.089878, 'C+57.021': 160.030645, 'M+15.995': 147.0354, 'K+42.011': 170.105528, 'C+57.02146+42.010565': 202.04121, 'C+42.010565+57.02146': 202.04121, 'G+57.02146+42.010565': 156.053489, 'G+42.010565+57.02146': 156.053489, 'A+57.02146+42.010565': 170.069139, 'A+42.010565+57.02146': 170.069139, 'S+57.02146+42.010565': 186.064053, 'S+42.010565+57.02146': 186.064053, 'P+57.02146+42.010565': 196.084789, 'P+42.010565+57.02146': 196.084789, 'V+57.02146+42.010565': 198.100439, 'V+42.010565+57.02146': 198.100439, 'T+57.02146+42.010565': 200.079695, 'T+42.010565+57.02146': 200.079695, 'L+57.02146+42.010565': 212.116089, 'L+42.010565+57.02146': 212.116089, 'I+57.02146+42.010565': 212.116089, 'I+42.010565+57.02146': 212.116089, 'N+57.02146+42.010565': 213.074952, 'N+42.010565+57.02146': 213.074952, 'D+57.02146+42.010565': 214.058968, 'D+42.010565+57.02146': 214.058968, 'Q+57.02146+42.010565': 227.090603, 'Q+42.010565+57.02146': 227.090603, 'K+57.02146+42.010565': 227.126988, 'K+42.010565+57.02146': 227.126988, 'E+57.02146+42.010565': 228.074618, 'E+42.010565+57.02146': 228.074618, 'M+57.02146+42.010565': 230.07251, 'M+42.010565+57.02146': 230.07251, 'H+57.02146+42.010565': 236.090937, 'H+42.010565+57.02146': 236.090937, 'F+57.02146+42.010565': 246.100439, 'F+42.010565+57.02146': 246.100439, 'R+57.02146+42.010565': 255.133136, 'R+42.010565+57.02146': 255.133136, 'Y+57.02146+42.010565': 262.095354, 'Y+42.010565+57.02146': 262.095354, 'W+57.02146+42.010565': 285.111338, 'W+42.010565+57.02146': 285.111338, 'G+57.02146+15.994915': 130.037839, 'G+15.994915+57.02146': 130.037839, 'A+57.02146+15.994915': 144.053489, 'A+15.994915+57.02146': 144.053489, 'S+57.02146+15.994915': 160.048403, 'S+15.994915+57.02146': 160.048403, 'P+57.02146+15.994915': 170.069139, 'P+15.994915+57.02146': 170.069139, 'V+57.02146+15.994915': 172.084789, 'V+15.994915+57.02146': 172.084789, 'T+57.02146+15.994915': 174.064045, 'T+15.994915+57.02146': 174.064045, 'C+57.02146+15.994915': 176.02556, 'C+15.994915+57.02146': 176.02556, 'L+57.02146+15.994915': 186.100439, 'L+15.994915+57.02146': 186.100439, 'I+57.02146+15.994915': 186.100439, 'I+15.994915+57.02146': 186.100439, 'N+57.02146+15.994915': 187.059302, 'N+15.994915+57.02146': 187.059302, 'D+57.02146+15.994915': 188.043318, 'D+15.994915+57.02146': 188.043318, 'Q+57.02146+15.994915': 201.074953, 'Q+15.994915+57.02146': 201.074953, 'K+57.02146+15.994915': 201.111338, 'K+15.994915+57.02146': 201.111338, 'E+57.02146+15.994915': 202.058968, 'E+15.994915+57.02146': 202.058968, 'M+57.02146+15.994915': 204.05686, 'M+15.994915+57.02146': 204.05686, 'H+57.02146+15.994915': 210.075287, 'H+15.994915+57.02146': 210.075287, 'F+57.02146+15.994915': 220.084789, 'F+15.994915+57.02146': 220.084789, 'R+57.02146+15.994915': 229.117486, 'R+15.994915+57.02146': 229.117486, 'Y+57.02146+15.994915': 236.079704, 'Y+15.994915+57.02146': 236.079704, 'W+57.02146+15.994915': 259.095688, 'W+15.994915+57.02146': 259.095688, 'G+15.994915+42.010565': 115.026944, 'G+42.010565+15.994915': 115.026944, 'A+15.994915+42.010565': 129.042594, 'A+42.010565+15.994915': 129.042594, 'S+15.994915+42.010565': 145.037508, 'S+42.010565+15.994915': 145.037508, 'P+15.994915+42.010565': 155.058244, 'P+42.010565+15.994915': 155.058244, 'V+15.994915+42.010565': 157.073894, 'V+42.010565+15.994915': 157.073894, 'T+15.994915+42.010565': 159.05315, 'T+42.010565+15.994915': 159.05315, 'C+15.994915+42.010565': 161.014665, 'C+42.010565+15.994915': 161.014665, 'L+15.994915+42.010565': 171.089544, 'L+42.010565+15.994915': 171.089544, 'I+15.994915+42.010565': 171.089544, 'I+42.010565+15.994915': 171.089544, 'N+15.994915+42.010565': 172.048407, 'N+42.010565+15.994915': 172.048407, 'D+15.994915+42.010565': 173.032423, 'D+42.010565+15.994915': 173.032423, 'Q+15.994915+42.010565': 186.064058, 'Q+42.010565+15.994915': 186.064058, 'K+15.994915+42.010565': 186.100443, 'K+42.010565+15.994915': 186.100443, 'E+15.994915+42.010565': 187.048073, 'E+42.010565+15.994915': 187.048073, 'M+15.994915+42.010565': 189.045965, 'M+42.010565+15.994915': 189.045965, 'H+15.994915+42.010565': 195.064392, 'H+42.010565+15.994915': 195.064392, 'F+15.994915+42.010565': 205.073894, 'F+42.010565+15.994915': 205.073894, 'R+15.994915+42.010565': 214.106591, 'R+42.010565+15.994915': 214.106591, 'Y+15.994915+42.010565': 221.068809, 'Y+42.010565+15.994915': 221.068809, 'W+15.994915+42.010565': 244.084793, 'W+42.010565+15.994915': 244.084793, 'G+57.02146+15.994915+42.010565': 172.048404, 'G+57.02146+42.010565+15.994915': 172.048404, 'G+15.994915+57.02146+42.010565': 172.048404, 'G+15.994915+42.010565+57.02146': 172.048404, 'G+42.010565+57.02146+15.994915': 172.048404, 'G+42.010565+15.994915+57.02146': 172.048404, 'A+57.02146+15.994915+42.010565': 186.064054, 'A+57.02146+42.010565+15.994915': 186.064054, 'A+15.994915+57.02146+42.010565': 186.064054, 'A+15.994915+42.010565+57.02146': 186.064054, 'A+42.010565+57.02146+15.994915': 186.064054, 'A+42.010565+15.994915+57.02146': 186.064054, 'S+57.02146+15.994915+42.010565': 202.058968, 'S+57.02146+42.010565+15.994915': 202.058968, 'S+15.994915+57.02146+42.010565': 202.058968, 'S+15.994915+42.010565+57.02146': 202.058968, 'S+42.010565+57.02146+15.994915': 202.058968, 'S+42.010565+15.994915+57.02146': 202.058968, 'P+57.02146+15.994915+42.010565': 212.079704, 'P+57.02146+42.010565+15.994915': 212.079704, 'P+15.994915+57.02146+42.010565': 212.079704, 'P+15.994915+42.010565+57.02146': 212.079704, 'P+42.010565+57.02146+15.994915': 212.079704, 'P+42.010565+15.994915+57.02146': 212.079704, 'V+57.02146+15.994915+42.010565': 214.095354, 'V+57.02146+42.010565+15.994915': 214.095354, 'V+15.994915+57.02146+42.010565': 214.095354, 'V+15.994915+42.010565+57.02146': 214.095354, 'V+42.010565+57.02146+15.994915': 214.095354, 'V+42.010565+15.994915+57.02146': 214.095354, 'T+57.02146+15.994915+42.010565': 216.07461, 'T+57.02146+42.010565+15.994915': 216.07461, 'T+15.994915+57.02146+42.010565': 216.07461, 'T+15.994915+42.010565+57.02146': 216.07461, 'T+42.010565+57.02146+15.994915': 216.07461, 'T+42.010565+15.994915+57.02146': 216.07461, 'C+57.02146+15.994915+42.010565': 218.036125, 'C+57.02146+42.010565+15.994915': 218.036125, 'C+15.994915+57.02146+42.010565': 218.036125, 'C+15.994915+42.010565+57.02146': 218.036125, 'C+42.010565+57.02146+15.994915': 218.036125, 'C+42.010565+15.994915+57.02146': 218.036125, 'L+57.02146+15.994915+42.010565': 228.111004, 'L+57.02146+42.010565+15.994915': 228.111004, 'L+15.994915+57.02146+42.010565': 228.111004, 'L+15.994915+42.010565+57.02146': 228.111004, 'L+42.010565+57.02146+15.994915': 228.111004, 'L+42.010565+15.994915+57.02146': 228.111004, 'I+57.02146+15.994915+42.010565': 228.111004, 'I+57.02146+42.010565+15.994915': 228.111004, 'I+15.994915+57.02146+42.010565': 228.111004, 'I+15.994915+42.010565+57.02146': 228.111004, 'I+42.010565+57.02146+15.994915': 228.111004, 'I+42.010565+15.994915+57.02146': 228.111004, 'N+57.02146+15.994915+42.010565': 229.069867, 'N+57.02146+42.010565+15.994915': 229.069867, 'N+15.994915+57.02146+42.010565': 229.069867, 'N+15.994915+42.010565+57.02146': 229.069867, 'N+42.010565+57.02146+15.994915': 229.069867, 'N+42.010565+15.994915+57.02146': 229.069867, 'D+57.02146+15.994915+42.010565': 230.053883, 'D+57.02146+42.010565+15.994915': 230.053883, 'D+15.994915+57.02146+42.010565': 230.053883, 'D+15.994915+42.010565+57.02146': 230.053883, 'D+42.010565+57.02146+15.994915': 230.053883, 'D+42.010565+15.994915+57.02146': 230.053883, 'Q+57.02146+15.994915+42.010565': 243.085518, 'Q+57.02146+42.010565+15.994915': 243.085518, 'Q+15.994915+57.02146+42.010565': 243.085518, 'Q+15.994915+42.010565+57.02146': 243.085518, 'Q+42.010565+57.02146+15.994915': 243.085518, 'Q+42.010565+15.994915+57.02146': 243.085518, 'K+57.02146+15.994915+42.010565': 243.121903, 'K+57.02146+42.010565+15.994915': 243.121903, 'K+15.994915+57.02146+42.010565': 243.121903, 'K+15.994915+42.010565+57.02146': 243.121903, 'K+42.010565+57.02146+15.994915': 243.121903, 'K+42.010565+15.994915+57.02146': 243.121903, 'E+57.02146+15.994915+42.010565': 244.069533, 'E+57.02146+42.010565+15.994915': 244.069533, 'E+15.994915+57.02146+42.010565': 244.069533, 'E+15.994915+42.010565+57.02146': 244.069533, 'E+42.010565+57.02146+15.994915': 244.069533, 'E+42.010565+15.994915+57.02146': 244.069533, 'M+57.02146+15.994915+42.010565': 246.067425, 'M+57.02146+42.010565+15.994915': 246.067425, 'M+15.994915+57.02146+42.010565': 246.067425, 'M+15.994915+42.010565+57.02146': 246.067425, 'M+42.010565+57.02146+15.994915': 246.067425, 'M+42.010565+15.994915+57.02146': 246.067425, 'H+57.02146+15.994915+42.010565': 252.085852, 'H+57.02146+42.010565+15.994915': 252.085852, 'H+15.994915+57.02146+42.010565': 252.085852, 'H+15.994915+42.010565+57.02146': 252.085852, 'H+42.010565+57.02146+15.994915': 252.085852, 'H+42.010565+15.994915+57.02146': 252.085852, 'F+57.02146+15.994915+42.010565': 262.095354, 'F+57.02146+42.010565+15.994915': 262.095354, 'F+15.994915+57.02146+42.010565': 262.095354, 'F+15.994915+42.010565+57.02146': 262.095354, 'F+42.010565+57.02146+15.994915': 262.095354, 'F+42.010565+15.994915+57.02146': 262.095354, 'R+57.02146+15.994915+42.010565': 271.128051, 'R+57.02146+42.010565+15.994915': 271.128051, 'R+15.994915+57.02146+42.010565': 271.128051, 'R+15.994915+42.010565+57.02146': 271.128051, 'R+42.010565+57.02146+15.994915': 271.128051, 'R+42.010565+15.994915+57.02146': 271.128051, 'Y+57.02146+15.994915+42.010565': 278.090269, 'Y+57.02146+42.010565+15.994915': 278.090269, 'Y+15.994915+57.02146+42.010565': 278.090269, 'Y+15.994915+42.010565+57.02146': 278.090269, 'Y+42.010565+57.02146+15.994915': 278.090269, 'Y+42.010565+15.994915+57.02146': 278.090269, 'W+57.02146+15.994915+42.010565': 301.106253, 'W+57.02146+42.010565+15.994915': 301.106253, 'W+15.994915+57.02146+42.010565': 301.106253, 'W+15.994915+42.010565+57.02146': 301.106253, 'W+42.010565+57.02146+15.994915': 301.106253, 'W+42.010565+15.994915+57.02146': 301.106253, '+42.010565': 42.010565, '+42.011': 42.010565, '+43.006': 43.005814, '-17.027': -17.026549, '+43.006-17.027': 25.980265}
2025-03-17 03:27:46,743 INFO [ptm/MainProcess] denovo.train : Training a model from:
2025-03-17 03:27:46,743 INFO [ptm/MainProcess] denovo.train :   src/datasets/train_set.mgf
2025-03-17 03:27:46,743 INFO [ptm/MainProcess] denovo.train : Using the following validation files:
2025-03-17 03:27:46,743 INFO [ptm/MainProcess] denovo.train :   src/datasets/val_set.mgf
2025-03-17 03:27:48,080 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 03:27:48,080 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/fabric/plugins/environments/slurm.py:165: PossibleUserWarning: The `srun` command is available on your system but is not used. HINT: If your intention is to run Lightning on SLURM, prepend your python command with `srun` like so: srun python main.py train src/datasets/train_set.mgf -p src/data ...
  rank_zero_warn(

2025-03-17 03:27:48,440 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 03:27:49,932 INFO [depthcharge.data.hdf5/MainProcess] hdf5.__init__ : Reading 1 files...
2025-03-17 03:27:50,392 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 03:27:50,392 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/torch/utils/data/dataloader.py:624: UserWarning: This DataLoader will create 28 worker processes in total. Our suggested max number of worker in current system is 4, which is smaller than what this DataLoader is going to create. Please be aware that excessive worker creation might get DataLoader running slow or even freeze, lower the worker number to avoid potential slowness/freeze if necessary.
  warnings.warn(

2025-03-17 03:27:50,481 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 03:27:50,481 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:612: UserWarning: Checkpoint directory  exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")

2025-03-17 03:28:20,781 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:28:20,781 WARNING [py.warnings/MainProcess] warnings._showwarnmsg : /home/malla.s/.conda/envs/microbe/lib/python3.11/site-packages/lightning/pytorch/utilities/data.py:77: UserWarning: Trying to infer the `batch_size` from an ambiguous collection. The batch size we found is 32. To avoid any miscalculations, use `self.log(..., batch_size=batch_size)`.
  warning_cache.warn(

2025-03-17 03:28:57,851 INFO [ptm/MainProcess] model._log_history : Step	Train loss	Valid loss	
2025-03-17 03:28:57,853 INFO [ptm/MainProcess] model._log_history : 250	5.191629	nan
2025-03-17 03:29:49,421 INFO [ptm/MainProcess] model._log_history : 500	3.509540	nan
2025-03-17 03:30:40,875 INFO [ptm/MainProcess] model._log_history : 750	2.998421	nan
2025-03-17 03:31:34,180 INFO [ptm/MainProcess] model._log_history : 1000	2.734356	nan
2025-03-17 03:32:26,111 INFO [ptm/MainProcess] model._log_history : 1250	2.593402	nan
2025-03-17 03:33:19,056 INFO [ptm/MainProcess] model._log_history : 1500	2.500205	nan
2025-03-17 03:34:11,410 INFO [ptm/MainProcess] model._log_history : 1750	2.421026	nan
2025-03-17 03:35:04,900 INFO [ptm/MainProcess] model._log_history : 2000	2.354126	nan
2025-03-17 03:35:56,956 INFO [ptm/MainProcess] model._log_history : 2250	2.292193	nan
2025-03-17 03:36:50,406 INFO [ptm/MainProcess] model._log_history : 2500	2.243299	nan
2025-03-17 03:36:51,507 INFO [ptm/MainProcess] denovo.train : DONE!
